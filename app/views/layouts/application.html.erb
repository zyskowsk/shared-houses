<!DOCTYPE html>
<html>
<head>
  <title>Shared Houses</title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
</head>
<body>

<div class="container">
	<% if house_signed_in? %>
		<div class="navbar">
		  <div class="navbar-inner">
			  <%= link_to current_house.address, house_path(current_house),
			  													:class => "brand"%>
		  <ul class="nav">
  			  <li class="dropdown">
  				  <a href="#" class="dropdown-toggle" data-toggle="dropdown">
  					  House
				  </a>
  				  <ul class="dropdown-menu">
  					  <li><%= link_to "logout", 						destroy_house_session_path, :method => :delete %></li>
  		 			 <% if mate_signed_in? && current_mate.admin? %>
  		 			  <li><%= link_to 'edit', edit_house_registration_path %></li>
  		 			 <% end %>
  				  </ul>
  			  </li>
		  </ul>
		  <ul class="nav">
		      <li class="dropdown">
		         <a href="#" class="dropdown-toggle" data-toggle="dropdown">
		           Mates
		         </a>
		         <ul class="dropdown-menu">
				 <% current_house.mates.where(current_use: true).each do |mate| %>
					<li><%= link_to mate.name, mate_path(mate)%></li>
				 <% end%>
				 <% if mate_signed_in? %>
				 	<li><%= link_to "logout to add a housemate", destroy_mate_session_path,
						 									 :method => :delete %></li>
				<% else %>
				 	<li><%= link_to 'Add a new Housemate', new_mate_registration_path%></li>
				<% end %>
		         </ul>
		     </li>
		 </ul>
		 <ul class="nav">
	         <li class="dropdown">
	            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
	              Statements
	            </a>
	            <ul class="dropdown-menu">
			    <% current_house.months.reverse.take(5).each do |month| %>
				   <li><%= link_to month.created_at.strftime("%b %d, %Y"), month_path(month)%></li>
			    <% end%>
				   <li><%= link_to "all statements", months_path %></li>
			    <% if mate_signed_in? && current_mate.admin? %>
			 	   <li><%= link_to 'create new statement', months_path,
					   								  :method => :post%></li>
			    <% end %>
	            </ul>
			</li>
		 </ul>
		 <ul class="nav pull-right">
		     <% if mate_signed_in? %>
	  			  <li class="dropdown">
					  <div class="btn-group">
		  				  <%= link_to current_mate.name, mate_path(current_mate), :class => "btn btn-info" %>
						  <button class="btn dropdown-toggle" data-toggle="dropdown">
						      <span class="caret"></span>
						  </button>

		  				  <ul class="dropdown-menu">
						 	  <li><%= link_to 'edit', edit_mate_registration_path(@mate) %></li>
						 	  <li><%= link_to "logout", destroy_mate_session_path,
						 									 :method => :delete %></li>

		  				  </ul>
					  </div>
	  			  </li>
 		 	 <% else %>
				 <%= form_for(resource, :html => {:class => "navbar-form"},
				 	 					:as => resource_name,
										:url => session_path(resource_name)) do |f| %>
				   <%= f.email_field :email, :autofocus => true, :class => "input-medium",
				   	 											 :placeholder => "Email" %>
				   <%= f.password_field :password, :class => "input-small",
				   	 							   :placeholder => "Password" %>

				   <%= f.submit "Sign in", :class => "btn btn-info" %>
				 <% end %>
 		 	<% end %>
		  </ul>
	   </div>
	</div>
	<% end %>
	<div class="row">
		<div class="span12">
			<% flash.each do |key, value| %>
			 <div class="alert">
				 <button type="button" class="close" data-dismiss="alert">&times;</button>
				 <%= value %>
			 </div>
			<% end %>
			<%= yield %>
		</div>
	</div>
</div>
<!--<%= debug(params) if Rails.env.development? %>-->



</body>
</html>
